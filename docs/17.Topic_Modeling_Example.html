<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>17&nbsp; Topic Modeling with R (Example) – Basic AI Programming</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./A.assignment1.html" rel="next">
<link href="./16.Topic_Modeling.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./17.Topic_Modeling_Example.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Topic Modeling with R (Example)</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Basic AI Programming</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting Up Environment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Constants and Variables in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Control Structures in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Functions and Packages in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data Analysis in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.arithmetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Basic Arithmetic Operations in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.Regular_Expression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regular Expressions (RegEx) in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.Custom_Corpus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Building a Custom Corpus</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.Preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Text Preprocessing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.Word_Cloud.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Visualizing Word Frequencies with Graphs and Word Clouds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.Text_Representation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Text Representation Based on Counts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.Word_Embedding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Word Embedding and Relational Similarity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.NLP_toolkit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Word Embedding Activities</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.Semantic_Network.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Semantic Network Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15.SNA_Example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Semantic Network Analysis (Examples)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16.Topic_Modeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Topic Modeling in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17.Topic_Modeling_Example.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Topic Modeling with R (Example)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A.assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Assignment #01</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./B.assignment2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Assignment #02: Semantic Network Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./C.assignment3_topic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Assignment #03:Topic Modeling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-use-topic-modeling-in-linguistics" id="toc-why-use-topic-modeling-in-linguistics" class="nav-link active" data-scroll-target="#why-use-topic-modeling-in-linguistics"><span class="header-section-number">17.1</span> Why Use Topic Modeling in Linguistics?</a></li>
  <li><a href="#getting-started-with-r-for-topic-modeling" id="toc-getting-started-with-r-for-topic-modeling" class="nav-link" data-scroll-target="#getting-started-with-r-for-topic-modeling"><span class="header-section-number">17.2</span> Getting Started with R for Topic Modeling</a></li>
  <li><a href="#install-and-load-necessary-packages" id="toc-install-and-load-necessary-packages" class="nav-link" data-scroll-target="#install-and-load-necessary-packages"><span class="header-section-number">17.3</span> Install and Load Necessary Packages</a></li>
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link" data-scroll-target="#data-import-and-preparation"><span class="header-section-number">17.4</span> Data Import and Preparation</a>
  <ul class="collapse">
  <li><a href="#importing-the-data" id="toc-importing-the-data" class="nav-link" data-scroll-target="#importing-the-data"><span class="header-section-number">17.4.1</span> Importing the Data</a></li>
  <li><a href="#adding-custom-stop-words" id="toc-adding-custom-stop-words" class="nav-link" data-scroll-target="#adding-custom-stop-words"><span class="header-section-number">17.4.2</span> Adding Custom Stop Words</a></li>
  </ul></li>
  <li><a href="#pre-processing-with-pos-tagging" id="toc-pre-processing-with-pos-tagging" class="nav-link" data-scroll-target="#pre-processing-with-pos-tagging"><span class="header-section-number">17.5</span> Pre-processing with POS Tagging</a>
  <ul class="collapse">
  <li><a href="#install-and-load-udpipe-for-pos-tagging" id="toc-install-and-load-udpipe-for-pos-tagging" class="nav-link" data-scroll-target="#install-and-load-udpipe-for-pos-tagging"><span class="header-section-number">17.5.1</span> Install and Load <code>udpipe</code> for POS Tagging</a></li>
  <li><a href="#define-the-pos-tagging-function" id="toc-define-the-pos-tagging-function" class="nav-link" data-scroll-target="#define-the-pos-tagging-function"><span class="header-section-number">17.5.2</span> Define the POS Tagging Function</a></li>
  <li><a href="#apply-pos-tagging-to-the-dataset" id="toc-apply-pos-tagging-to-the-dataset" class="nav-link" data-scroll-target="#apply-pos-tagging-to-the-dataset"><span class="header-section-number">17.5.3</span> Apply POS Tagging to the Dataset</a></li>
  <li><a href="#clean-the-tokenized-data" id="toc-clean-the-tokenized-data" class="nav-link" data-scroll-target="#clean-the-tokenized-data"><span class="header-section-number">17.5.4</span> Clean the Tokenized Data</a></li>
  </ul></li>
  <li><a href="#model-building-creating-the-document-feature-matrix-dfm" id="toc-model-building-creating-the-document-feature-matrix-dfm" class="nav-link" data-scroll-target="#model-building-creating-the-document-feature-matrix-dfm"><span class="header-section-number">17.6</span> Model Building: Creating the Document-Feature Matrix (DFM)</a>
  <ul class="collapse">
  <li><a href="#aggregate-token-counts-per-document" id="toc-aggregate-token-counts-per-document" class="nav-link" data-scroll-target="#aggregate-token-counts-per-document"><span class="header-section-number">17.6.1</span> Aggregate Token Counts per Document</a></li>
  <li><a href="#convert-to-document-feature-matrix-dfm" id="toc-convert-to-document-feature-matrix-dfm" class="nav-link" data-scroll-target="#convert-to-document-feature-matrix-dfm"><span class="header-section-number">17.6.2</span> Convert to Document-Feature Matrix (DFM)</a></li>
  <li><a href="#trim-the-dfm" id="toc-trim-the-dfm" class="nav-link" data-scroll-target="#trim-the-dfm"><span class="header-section-number">17.6.3</span> Trim the DFM</a></li>
  <li><a href="#save-the-trimmed-dfm" id="toc-save-the-trimmed-dfm" class="nav-link" data-scroll-target="#save-the-trimmed-dfm"><span class="header-section-number">17.6.4</span> Save the Trimmed DFM</a></li>
  </ul></li>
  <li><a href="#building-and-evaluating-the-lda-model" id="toc-building-and-evaluating-the-lda-model" class="nav-link" data-scroll-target="#building-and-evaluating-the-lda-model"><span class="header-section-number">17.7</span> Building and Evaluating the LDA Model</a>
  <ul class="collapse">
  <li><a href="#convert-dfm-to-document-term-matrix-dtm" id="toc-convert-dfm-to-document-term-matrix-dtm" class="nav-link" data-scroll-target="#convert-dfm-to-document-term-matrix-dtm"><span class="header-section-number">17.7.1</span> Convert DFM to Document-Term Matrix (DTM)</a></li>
  <li><a href="#set-up-parallel-processing-for-cross-validation" id="toc-set-up-parallel-processing-for-cross-validation" class="nav-link" data-scroll-target="#set-up-parallel-processing-for-cross-validation"><span class="header-section-number">17.7.2</span> Set Up Parallel Processing for Cross-Validation</a></li>
  <li><a href="#define-lda-model-parameters-and-cross-validation-settings" id="toc-define-lda-model-parameters-and-cross-validation-settings" class="nav-link" data-scroll-target="#define-lda-model-parameters-and-cross-validation-settings"><span class="header-section-number">17.7.3</span> Define LDA Model Parameters and Cross-Validation Settings</a></li>
  <li><a href="#perform-5-fold-cross-validation-for-perplexity-calculation" id="toc-perform-5-fold-cross-validation-for-perplexity-calculation" class="nav-link" data-scroll-target="#perform-5-fold-cross-validation-for-perplexity-calculation"><span class="header-section-number">17.7.4</span> Perform 5-Fold Cross-Validation for Perplexity Calculation</a></li>
  <li><a href="#visualize-the-perplexity-scores-for-different-topic-counts" id="toc-visualize-the-perplexity-scores-for-different-topic-counts" class="nav-link" data-scroll-target="#visualize-the-perplexity-scores-for-different-topic-counts"><span class="header-section-number">17.7.5</span> Visualize the Perplexity Scores for Different Topic Counts</a></li>
  </ul></li>
  <li><a href="#training-and-analyzing-the-lda-model" id="toc-training-and-analyzing-the-lda-model" class="nav-link" data-scroll-target="#training-and-analyzing-the-lda-model"><span class="header-section-number">17.8</span> Training and Analyzing the LDA Model</a>
  <ul class="collapse">
  <li><a href="#define-the-number-of-topics-and-train-the-lda-model" id="toc-define-the-number-of-topics-and-train-the-lda-model" class="nav-link" data-scroll-target="#define-the-number-of-topics-and-train-the-lda-model"><span class="header-section-number">17.8.1</span> Define the Number of Topics and Train the LDA Model</a></li>
  <li><a href="#extract-posterior-distributions" id="toc-extract-posterior-distributions" class="nav-link" data-scroll-target="#extract-posterior-distributions"><span class="header-section-number">17.8.2</span> Extract Posterior Distributions</a></li>
  <li><a href="#analyze-the-topic-term-distribution-beta" id="toc-analyze-the-topic-term-distribution-beta" class="nav-link" data-scroll-target="#analyze-the-topic-term-distribution-beta"><span class="header-section-number">17.8.3</span> Analyze the Topic-Term Distribution (<code>beta</code>)</a></li>
  <li><a href="#analyze-the-document-topic-distribution-theta" id="toc-analyze-the-document-topic-distribution-theta" class="nav-link" data-scroll-target="#analyze-the-document-topic-distribution-theta"><span class="header-section-number">17.8.4</span> Analyze the Document-Topic Distribution (<code>theta</code>)</a></li>
  <li><a href="#create-and-save-a-matrix-of-top-words-for-each-topic" id="toc-create-and-save-a-matrix-of-top-words-for-each-topic" class="nav-link" data-scroll-target="#create-and-save-a-matrix-of-top-words-for-each-topic"><span class="header-section-number">17.8.5</span> Create and Save a Matrix of Top Words for Each Topic</a></li>
  </ul></li>
  <li><a href="#extracting-and-visualizing-topics" id="toc-extracting-and-visualizing-topics" class="nav-link" data-scroll-target="#extracting-and-visualizing-topics"><span class="header-section-number">17.9</span> Extracting and Visualizing Topics</a>
  <ul class="collapse">
  <li><a href="#extract-the-top-15-words-for-each-topic" id="toc-extract-the-top-15-words-for-each-topic" class="nav-link" data-scroll-target="#extract-the-top-15-words-for-each-topic"><span class="header-section-number">17.9.1</span> Extract the Top 15 Words for Each Topic</a></li>
  <li><a href="#visualize-the-lda-model-with-ldavis" id="toc-visualize-the-lda-model-with-ldavis" class="nav-link" data-scroll-target="#visualize-the-lda-model-with-ldavis"><span class="header-section-number">17.9.2</span> Visualize the LDA Model with <code>LDAvis</code></a></li>
  </ul></li>
  <li><a href="#topic-ranking-and-trends" id="toc-topic-ranking-and-trends" class="nav-link" data-scroll-target="#topic-ranking-and-trends"><span class="header-section-number">17.10</span> Topic Ranking and Trends</a>
  <ul class="collapse">
  <li><a href="#step-1-rank-topics-by-defining-terms" id="toc-step-1-rank-topics-by-defining-terms" class="nav-link" data-scroll-target="#step-1-rank-topics-by-defining-terms"><span class="header-section-number">17.10.1</span> Step 1: Rank Topics by Defining Terms</a></li>
  <li><a href="#step-2-calculate-overall-topic-proportions" id="toc-step-2-calculate-overall-topic-proportions" class="nav-link" data-scroll-target="#step-2-calculate-overall-topic-proportions"><span class="header-section-number">17.10.2</span> Step 2: Calculate Overall Topic Proportions</a></li>
  <li><a href="#step-3-count-primary-topics-in-each-document" id="toc-step-3-count-primary-topics-in-each-document" class="nav-link" data-scroll-target="#step-3-count-primary-topics-in-each-document"><span class="header-section-number">17.10.3</span> Step 3: Count Primary Topics in Each Document</a></li>
  </ul></li>
  <li><a href="#hot-and-cold-topics-analysis" id="toc-hot-and-cold-topics-analysis" class="nav-link" data-scroll-target="#hot-and-cold-topics-analysis"><span class="header-section-number">17.11</span> Hot and Cold Topics Analysis</a>
  <ul class="collapse">
  <li><a href="#step-1-prepare-data-for-temporal-analysis" id="toc-step-1-prepare-data-for-temporal-analysis" class="nav-link" data-scroll-target="#step-1-prepare-data-for-temporal-analysis"><span class="header-section-number">17.11.1</span> Step 1: Prepare Data for Temporal Analysis</a></li>
  <li><a href="#step-2-calculate-topic-proportions-over-time" id="toc-step-2-calculate-topic-proportions-over-time" class="nav-link" data-scroll-target="#step-2-calculate-topic-proportions-over-time"><span class="header-section-number">17.11.2</span> Step 2: Calculate Topic Proportions Over Time</a></li>
  </ul></li>
  <li><a href="#hot-and-cold-topics-analysis-1" id="toc-hot-and-cold-topics-analysis-1" class="nav-link" data-scroll-target="#hot-and-cold-topics-analysis-1"><span class="header-section-number">17.12</span> Hot and Cold Topics Analysis</a>
  <ul class="collapse">
  <li><a href="#step-1-calculate-mean-topic-proportions-by-year" id="toc-step-1-calculate-mean-topic-proportions-by-year" class="nav-link" data-scroll-target="#step-1-calculate-mean-topic-proportions-by-year"><span class="header-section-number">17.12.1</span> Step 1: Calculate Mean Topic Proportions by Year</a></li>
  <li><a href="#step-2-identify-hot-and-cold-topics-with-linear-regression" id="toc-step-2-identify-hot-and-cold-topics-with-linear-regression" class="nav-link" data-scroll-target="#step-2-identify-hot-and-cold-topics-with-linear-regression"><span class="header-section-number">17.12.2</span> Step 2: Identify Hot and Cold Topics with Linear Regression</a></li>
  <li><a href="#step-3-evaluate-significance-levels" id="toc-step-3-evaluate-significance-levels" class="nav-link" data-scroll-target="#step-3-evaluate-significance-levels"><span class="header-section-number">17.12.3</span> Step 3: Evaluate Significance Levels</a></li>
  <li><a href="#step-4-visualize-hot-and-cold-topics" id="toc-step-4-visualize-hot-and-cold-topics" class="nav-link" data-scroll-target="#step-4-visualize-hot-and-cold-topics"><span class="header-section-number">17.12.4</span> Step 4: Visualize Hot and Cold Topics</a></li>
  <li><a href="#step-5-summarize-time-series-analysis-results" id="toc-step-5-summarize-time-series-analysis-results" class="nav-link" data-scroll-target="#step-5-summarize-time-series-analysis-results"><span class="header-section-number">17.12.5</span> Step 5: Summarize Time-Series Analysis Results</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Topic Modeling with R (Example)</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="why-use-topic-modeling-in-linguistics" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="why-use-topic-modeling-in-linguistics"><span class="header-section-number">17.1</span> Why Use Topic Modeling in Linguistics?</h2>
<p>In linguistics, topic modeling is particularly valuable because it allows researchers to:</p>
<ul>
<li>Identify patterns and themes in large collections of texts.</li>
<li>Analyze thematic structures without needing pre-labeled data.</li>
<li>Gain insights into the linguistic or cultural elements underlying different topics.</li>
</ul>
<p>Common applications include examining corpora such as:</p>
<ul>
<li>Academic articles to find recurring themes.</li>
<li>Social media data to analyze discourse.</li>
<li>Historical texts to trace the evolution of ideas over time.</li>
</ul>
</section>
<section id="getting-started-with-r-for-topic-modeling" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="getting-started-with-r-for-topic-modeling"><span class="header-section-number">17.2</span> Getting Started with R for Topic Modeling</h2>
<p>To conduct topic modeling in R, we use the <code>topicmodels</code> package, which implements Latent Dirichlet Allocation (LDA), the most popular topic modeling algorithm. Here’s how to get started.</p>
</section>
<section id="install-and-load-necessary-packages" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="install-and-load-necessary-packages"><span class="header-section-number">17.3</span> Install and Load Necessary Packages</h2>
<p>First, we need to install and load several packages: - <code>tm</code> for text mining and preprocessing, - <code>topicmodels</code> for creating the LDA model, and - <code>tidyverse</code> and <code>tidytext</code> for data manipulation and visualization.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install packages if not already installed</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tm"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"topicmodels"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidytext"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the libraries</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tm' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: NLP</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ ggplot2::annotate() masks NLP::annotate()
✖ dplyr::filter()     masks stats::filter()
✖ dplyr::lag()        masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import-and-preparation" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="data-import-and-preparation"><span class="header-section-number">17.4</span> Data Import and Preparation</h2>
<p>Before we dive into topic modeling, let’s learn how to import data and prepare it for analysis. This step is essential for linguistics research since it ensures that we start with clean, manageable text data.</p>
<section id="importing-the-data" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="importing-the-data"><span class="header-section-number">17.4.1</span> Importing the Data</h3>
<p>For this example, we assume we have a CSV file named <code>data_topicmodeling.csv</code>. This file contains a collection of academic texts, with each row representing a document. The CSV file should be in the same working directory as your R script or project, or you should specify the full path.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the dataset</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data_topicmodeling.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1526 Columns: 5
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): author, title_eng, journal_short, abstract
dbl (1): year

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a unique identifier for each document</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">rowid_to_column</span>(data, <span class="st">"doc_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code reads in the CSV file and creates a new column called <code>doc_id</code>, assigning a unique identifier to each document. The <code>doc_id</code> column will help us keep track of documents when we analyze and interpret the results.</p>
</section>
<section id="adding-custom-stop-words" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="adding-custom-stop-words"><span class="header-section-number">17.4.2</span> Adding Custom Stop Words</h3>
<p>In academic texts, there may be specific words or phrases frequently used across documents but not meaningful for topic modeling. For example, terms like “study,” “results,” or “analysis” may appear often but do not contribute to distinct thematic content. In this case, we use a custom stop words file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load custom stop words</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>stop_words <span class="ot">&lt;-</span> <span class="fu">readLines</span>(<span class="st">"academic_stopwords.txt"</span>, <span class="at">encoding =</span> <span class="st">"UTF-8"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, <code>academic_stopwords.txt</code> is a text file with one stop word per line, such as “method,” “study,” or “analysis.” Make sure this file is in your working directory or specify its full path. Loading these stop words allows us to exclude them during preprocessing, helping to focus the model on more meaningful terms.</p>
</section>
</section>
<section id="pre-processing-with-pos-tagging" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="pre-processing-with-pos-tagging"><span class="header-section-number">17.5</span> Pre-processing with POS Tagging</h2>
<p>Pre-processing with POS tagging helps us target specific types of words relevant to topic analysis. In linguistics, POS tagging can reveal the syntactic categories of words (e.g., noun, verb, adjective), allowing us to select only the most meaningful words for topic modeling.</p>
<section id="install-and-load-udpipe-for-pos-tagging" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="install-and-load-udpipe-for-pos-tagging"><span class="header-section-number">17.5.1</span> Install and Load <code>udpipe</code> for POS Tagging</h3>
<p><code>udpipe</code> is an R package that provides access to pre-trained language models for POS tagging and dependency parsing. First, ensure <code>udpipe</code> is installed, then load it and download the English language model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the udpipe package</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('udpipe')</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(udpipe)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Download the English language model</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ud_model &lt;- udpipe_download_model(language = "english")</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the language model</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ud_model &lt;- udpipe_load_model(ud_model$file_model)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>ud_model <span class="ot">&lt;-</span> <span class="fu">udpipe_load_model</span>(<span class="st">"english-ewt-ud-2.5-191206.udpipe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-the-pos-tagging-function" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="define-the-pos-tagging-function"><span class="header-section-number">17.5.2</span> Define the POS Tagging Function</h3>
<p>The function <code>ud_tagger_f</code> below uses <code>udpipe</code> to annotate each document in our dataset. This function:</p>
<ul>
<li>Applies POS tagging on the <code>abstract</code> column of our dataset.</li>
<li>Filters out terms listed in the <code>stop_words</code> file.</li>
<li>Selects only words classified as verbs, nouns, adjectives, or adverbs (since these words typically carry more thematic meaning).</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the POS tagging function</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ud_tagger_f <span class="ot">&lt;-</span> <span class="cf">function</span>(input) {</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">udpipe_annotate</span>(ud_model, <span class="at">x =</span> input<span class="sc">$</span>abstract, <span class="at">doc_id =</span> input<span class="sc">$</span>doc_id, <span class="at">year =</span> input<span class="sc">$</span>year) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>lemma <span class="sc">%in%</span> stop_words) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">subset</span>(upos <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"VERB"</span>, <span class="st">"NOUN"</span>, <span class="st">"ADJ"</span>, <span class="st">"ADV"</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="apply-pos-tagging-to-the-dataset" class="level3" data-number="17.5.3">
<h3 data-number="17.5.3" class="anchored" data-anchor-id="apply-pos-tagging-to-the-dataset"><span class="header-section-number">17.5.3</span> Apply POS Tagging to the Dataset</h3>
<p>The next step is to apply our <code>ud_tagger_f</code> function to the dataset and save the results. This tagged dataset will focus only on the filtered POS categories and exclude irrelevant words.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply POS tagging to the data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>data_tag <span class="ot">&lt;-</span> <span class="fu">ud_tagger_f</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="clean-the-tokenized-data" class="level3" data-number="17.5.4">
<h3 data-number="17.5.4" class="anchored" data-anchor-id="clean-the-tokenized-data"><span class="header-section-number">17.5.4</span> Clean the Tokenized Data</h3>
<p>With the POS-tagged data, we can now proceed to additional cleaning steps: 1. Remove numeric characters. 2. Delete punctuation. 3. Filter out single-character words, as they typically add little value. 4. Delete empty lemmas (words that become empty after cleaning).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select relevant columns and clean tokens</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>text_cleaning_tokens <span class="ot">&lt;-</span> data_tag <span class="sc">%&gt;%</span> <span class="fu">select</span>(doc_id, lemma)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove numbers and punctuation</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>text_cleaning_tokens<span class="sc">$</span>lemma <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'[[:digit:]]+'</span>, <span class="st">''</span>, text_cleaning_tokens<span class="sc">$</span>lemma)  <span class="co"># Remove numbers</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>text_cleaning_tokens<span class="sc">$</span>lemma <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">'[[:punct:]]+'</span>, <span class="st">''</span>, text_cleaning_tokens<span class="sc">$</span>lemma)  <span class="co"># Remove punctuation</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out one-letter words</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>text_cleaning_tokens <span class="ot">&lt;-</span> text_cleaning_tokens <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">nchar</span>(lemma) <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty lemmas</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> text_cleaning_tokens <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(lemma <span class="sc">==</span> <span class="st">""</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add an index column for tracking purposes</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>tokens <span class="ot">&lt;-</span> tokens <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ind =</span> <span class="fu">row_number</span>())</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tokens, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  doc_id      lemma ind
1      1    purpose   1
2      1    explain   2
3      1 difference   3</code></pre>
</div>
</div>
<p>In the above code:</p>
<ul>
<li><p><code>gsub('[[:digit:]]+', '', text_cleaning_tokens$lemma)</code> removes any numeric characters.</p></li>
<li><p><code>gsub('[[:punct:]]+', '', text_cleaning_tokens$lemma)</code> removes punctuation.</p></li>
<li><p><code>filter(!(nchar(lemma) == 1))</code> filters out any single-character words.</p></li>
<li><p>Finally, we remove any empty rows created by filtering.</p></li>
</ul>
<p>The result is a cleaned dataset called <code>tokens</code>, ready for topic modeling.</p>
</section>
</section>
<section id="model-building-creating-the-document-feature-matrix-dfm" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="model-building-creating-the-document-feature-matrix-dfm"><span class="header-section-number">17.6</span> Model Building: Creating the Document-Feature Matrix (DFM)</h2>
<p>After pre-processing, the next step in topic modeling is to create a DFM, which transforms our tokenized text data into a matrix suitable for topic modeling.</p>
<section id="aggregate-token-counts-per-document" class="level3" data-number="17.6.1">
<h3 data-number="17.6.1" class="anchored" data-anchor-id="aggregate-token-counts-per-document"><span class="header-section-number">17.6.1</span> Aggregate Token Counts per Document</h3>
<p>First, we need to calculate the frequency of each term (lemma) within each document. This step ensures that the DFM accurately reflects the number of times each term appears in each document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate token counts per document</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>tokens_doc <span class="ot">&lt;-</span> tokens <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc_id, lemma) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'doc_id'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Here, we use <code>group_by(doc_id, lemma)</code> to group the data by each document and term, and <code>summarise(count = n())</code> to calculate the count of each term in each document.</p>
</section>
<section id="convert-to-document-feature-matrix-dfm" class="level3" data-number="17.6.2">
<h3 data-number="17.6.2" class="anchored" data-anchor-id="convert-to-document-feature-matrix-dfm"><span class="header-section-number">17.6.2</span> Convert to Document-Feature Matrix (DFM)</h3>
<p>We use the <code>quanteda</code> and <code>tidytext</code> packages to convert our data into a DFM format, which is required for topic modeling. The <code>cast_dfm</code> function in <code>tidytext</code> helps convert a tidy data frame into a DFM.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary packages</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quanteda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'quanteda' was built under R version 4.3.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in .recacheSubclasses(def@className, def, env): undefined subclass
"ndiMatrix" of class "replValueSp"; definition not updated</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Package version: 4.1.0
Unicode version: 14.0
ICU version: 71.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Parallel computing: disabled</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>See https://quanteda.io for tutorials and examples.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'quanteda'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tm':

    stopwords</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:NLP':

    meta, meta&lt;-</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to Document-Feature Matrix</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> tokens_doc <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dfm</span>(doc_id, lemma, count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>cast_dfm</code> function takes three arguments:</p>
<ul>
<li><p><code>doc_id</code>: the document identifier column,</p></li>
<li><p><code>lemma</code>: the term or feature column, and</p></li>
<li><p><code>count</code>: the frequency count of each term in each document.</p></li>
</ul>
<p>The resulting DFM will have documents as rows, terms as columns, and frequency counts as the matrix values.</p>
<p>To check the dimensions of the DFM:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions of the DFM</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1517 6773</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output: [1517, 6773]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here, <code>1517</code> represents the number of documents, and <code>6773</code> represents the unique terms (or features) across all documents.</p>
</section>
<section id="trim-the-dfm" class="level3" data-number="17.6.3">
<h3 data-number="17.6.3" class="anchored" data-anchor-id="trim-the-dfm"><span class="header-section-number">17.6.3</span> Trim the DFM</h3>
<p>To reduce sparsity in the DFM and improve the model’s focus, we apply frequency thresholds. Removing terms that appear very infrequently helps in reducing noise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim the DFM</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>trimmed_dfm <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfm, <span class="at">min_termfreq =</span> <span class="dv">5</span>, <span class="at">min_docfreq =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this command: - <code>min_termfreq = 5</code> removes terms that appear fewer than 5 times across all documents. - <code>min_docfreq = 10</code> removes terms that appear in fewer than 10 documents.</p>
<p>After trimming, we check the new dimensions of the DFM:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dimensions after trimming</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(trimmed_dfm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1517 1287</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Expected output: [1517, 1287]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this example, the DFM is reduced to 1287 terms after removing low-frequency terms.</p>
</section>
<section id="save-the-trimmed-dfm" class="level3" data-number="17.6.4">
<h3 data-number="17.6.4" class="anchored" data-anchor-id="save-the-trimmed-dfm"><span class="header-section-number">17.6.4</span> Save the Trimmed DFM</h3>
<p>Saving the trimmed DFM allows us to use this matrix as input for our topic model in the next steps. It’s often helpful to save it as a CSV file for future use or verification.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the DFM to a data frame using `convert`</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>dfm_dataframe <span class="ot">&lt;-</span> <span class="fu">convert</span>(trimmed_dfm, <span class="at">to =</span> <span class="st">"data.frame"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the data frame to a CSV file</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(dfm_dataframe, <span class="st">"trimmed_dfm.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This file, <code>trimmed_dfm.csv</code>, is now ready for further analysis or to serve as the input for topic modeling.</p>
<p>To display the top features (most frequent terms) in the trimmed Document-Feature Matrix (DFM), we can use the <code>topfeatures</code> function from the <code>quanteda</code> package. This function will show the 20 most frequent terms in the <code>trimmed_dfm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the top 20 features in the trimmed DFM</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>top_terms <span class="ot">&lt;-</span> <span class="fu">topfeatures</span>(trimmed_dfm, <span class="at">n =</span> <span class="dv">20</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>top_terms</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   student    teacher    English        use      learn   language     school 
      3765       2311       2226       2111       1934       1515       1381 
   learner      class elementary       test   teaching   activity      write 
      1227       1027        985        984        931        921        916 
    effect    purpose vocabulary  classroom  education    program 
       746        728        698        677        653        644 </code></pre>
</div>
</div>
<ul>
<li><code>topfeatures(trimmed_dfm, n = 20)</code> retrieves the 20 most frequent terms (features) in the <code>trimmed_dfm</code>.</li>
<li><code>top_terms</code> will be a named vector where the names are terms, and the values are their frequencies across the corpus.</li>
</ul>
</section>
</section>
<section id="building-and-evaluating-the-lda-model" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="building-and-evaluating-the-lda-model"><span class="header-section-number">17.7</span> Building and Evaluating the LDA Model</h2>
<p>This section covers <strong>Latent Dirichlet Allocation (LDA) with Perplexity Calculation</strong>. In this approach, we implement an LDA model and use cross-validation to determine the optimal number of topics by minimizing perplexity, a measure of model quality. This is done through 5-fold cross-validation, testing multiple topic counts to find the most appropriate configuration for the topic model.</p>
<section id="convert-dfm-to-document-term-matrix-dtm" class="level3" data-number="17.7.1">
<h3 data-number="17.7.1" class="anchored" data-anchor-id="convert-dfm-to-document-term-matrix-dtm"><span class="header-section-number">17.7.1</span> Convert DFM to Document-Term Matrix (DTM)</h3>
<p>To run an LDA model using the <code>topicmodels</code> package, we need the data in a <code>DocumentTermMatrix</code> format. The <code>convert</code> function from the <code>quanteda</code> package simplifies this process, converting the <code>trimmed_dfm</code> to a DTM format compatible with <code>topicmodels</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the necessary package</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the trimmed DFM to a Document-Term Matrix for topic modeling</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> <span class="fu">convert</span>(trimmed_dfm, <span class="at">to =</span> <span class="st">"topicmodels"</span>, <span class="at">omit_empty =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the dimensions of the DTM</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dtm) <span class="co"># Expected output: [1517, 1287]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1517 1287</code></pre>
</div>
</div>
</section>
<section id="set-up-parallel-processing-for-cross-validation" class="level3" data-number="17.7.2">
<h3 data-number="17.7.2" class="anchored" data-anchor-id="set-up-parallel-processing-for-cross-validation"><span class="header-section-number">17.7.2</span> Set Up Parallel Processing for Cross-Validation</h3>
<p>To optimize the topic model, we use 5-fold cross-validation across multiple values of <code>k</code> (the number of topics). Parallel processing speeds up this process by allowing each fold or candidate <code>k</code> value to be processed on a separate CPU core.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load libraries for parallel processing</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: foreach</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'foreach'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:purrr':

    accumulate, when</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: iterators</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    discard</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up a cluster with one fewer core than available</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="fu">detectCores</span>(<span class="at">logical =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load `topicmodels` on all cluster nodes</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterEvalQ</span>(cluster, {</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">library</span>(topicmodels)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[2]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[3]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[4]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[5]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[6]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       

[[7]]
[1] "topicmodels" "stats"       "graphics"    "grDevices"   "utils"      
[6] "datasets"    "methods"     "base"       </code></pre>
</div>
</div>
</section>
<section id="define-lda-model-parameters-and-cross-validation-settings" class="level3" data-number="17.7.3">
<h3 data-number="17.7.3" class="anchored" data-anchor-id="define-lda-model-parameters-and-cross-validation-settings"><span class="header-section-number">17.7.3</span> Define LDA Model Parameters and Cross-Validation Settings</h3>
<p>Set the parameters for the LDA model:</p>
<ul>
<li><p><code>burnin</code>, <code>iter</code>, and <code>keep</code> control the Gibbs sampling process.</p></li>
<li><p><code>folds</code> sets the number of cross-validation folds.</p></li>
<li><p><code>candidate_k</code> provides the values of <code>k</code> (number of topics) to test.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define LDA model parameters</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>burnin <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>keep <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Define cross-validation settings</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dtm)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>splitfolds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>folds, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>candidate_k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">30</span>) <span class="co"># different candidate values for the number of topics</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Export necessary objects to all cluster nodes</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="fu">clusterExport</span>(cluster, <span class="fu">c</span>(<span class="st">"dtm"</span>, <span class="st">"burnin"</span>, <span class="st">"iter"</span>, <span class="st">"keep"</span>, <span class="st">"splitfolds"</span>, <span class="st">"folds"</span>, <span class="st">"candidate_k"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="perform-5-fold-cross-validation-for-perplexity-calculation" class="level3" data-number="17.7.4">
<h3 data-number="17.7.4" class="anchored" data-anchor-id="perform-5-fold-cross-validation-for-perplexity-calculation"><span class="header-section-number">17.7.4</span> Perform 5-Fold Cross-Validation for Perplexity Calculation</h3>
<p>The <code>foreach</code> loop runs cross-validation for each candidate value of <code>k</code> in parallel. For each candidate <code>k</code>, it: 1. Splits the data into training and validation sets. 2. Fits an LDA model on the training set. 3. Calculates the perplexity on the validation set.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run cross-validation for each candidate number of topics</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>({</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">foreach</span>(<span class="at">j =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(candidate_k), <span class="at">.combine =</span> rbind) <span class="sc">%dopar%</span> {</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     k <span class="ot">&lt;-</span> candidate_k[j]</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     results_1k <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> folds, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">colnames</span>(results_1k) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"k"</span>, <span class="st">"perplexity"</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>     <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>folds){</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>        train_set <span class="ot">&lt;-</span> dtm[splitfolds <span class="sc">!=</span> i, ]</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        valid_set <span class="ot">&lt;-</span> dtm[splitfolds <span class="sc">==</span> i, ]</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        fitted <span class="ot">&lt;-</span> <span class="fu">LDA</span>(train_set, <span class="at">k =</span> k, <span class="at">method =</span> <span class="st">"Gibbs"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">control =</span> <span class="fu">list</span>(<span class="at">burnin =</span> burnin, <span class="at">iter =</span> iter, <span class="at">keep =</span> keep))</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        results_1k[i,] <span class="ot">&lt;-</span> <span class="fu">c</span>(k, <span class="fu">perplexity</span>(fitted, <span class="at">newdata =</span> valid_set))</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">return</span>(results_1k)</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Stop the cluster after cross-validation</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert results to a data frame</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="visualize-the-perplexity-scores-for-different-topic-counts" class="level3" data-number="17.7.5">
<h3 data-number="17.7.5" class="anchored" data-anchor-id="visualize-the-perplexity-scores-for-different-topic-counts"><span class="header-section-number">17.7.5</span> Visualize the Perplexity Scores for Different Topic Counts</h3>
<p>To determine the optimal number of topics, plot the perplexity scores against the candidate values of <code>k</code>. The <code>ggplot2</code> package provides a straightforward way to visualize this relationship.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load ggplot2 for plotting</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot perplexity scores for each candidate number of topics</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(results_df, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> perplexity)) <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggtitle</span>(<span class="st">"5-Fold Cross-Validation of Topic Modeling"</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Candidate Number of Topics"</span>, <span class="at">y =</span> <span class="st">"Perplexity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="images/Screenshot 2024-11-12 at 23.14.35.png" class="img-fluid"></p>
<p>In the plot, the x-axis represents the number of topics, and the y-axis shows the perplexity scores. The optimal number of topics minimizes perplexity, indicating a balance between model complexity and generalization to unseen data.</p>
</section>
</section>
<section id="training-and-analyzing-the-lda-model" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="training-and-analyzing-the-lda-model"><span class="header-section-number">17.8</span> Training and Analyzing the LDA Model</h2>
<p>After determining the optimal number of topics, we can train a final LDA model using the entire dataset. This section demonstrates how to build the model, interpret its results, and save relevant matrices for further analysis.</p>
<section id="define-the-number-of-topics-and-train-the-lda-model" class="level3" data-number="17.8.1">
<h3 data-number="17.8.1" class="anchored" data-anchor-id="define-the-number-of-topics-and-train-the-lda-model"><span class="header-section-number">17.8.1</span> Define the Number of Topics and Train the LDA Model</h3>
<p>In this example, we set <code>K = 10</code> to define the number of topics and train the model using the Gibbs sampling method, a common approach for LDA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the topicmodels package</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the number of topics</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the LDA model</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>lda_model <span class="ot">&lt;-</span> <span class="fu">LDA</span>(dtm, <span class="at">k =</span> K, <span class="at">method =</span> <span class="st">"Gibbs"</span>, </span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">50</span><span class="sc">/</span>K, <span class="at">delta =</span> <span class="fl">0.1</span>, <span class="at">verbose =</span> <span class="dv">25</span>L, </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">burnin =</span> <span class="dv">100</span>, <span class="at">iter =</span> <span class="dv">500</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>K = 10; V = 1287; M = 1517
Sampling 600 iterations!
Iteration 25 ...
Iteration 50 ...
Iteration 75 ...
Iteration 100 ...
Iteration 125 ...
Iteration 150 ...
Iteration 175 ...
Iteration 200 ...
Iteration 225 ...
Iteration 250 ...
Iteration 275 ...
Iteration 300 ...
Iteration 325 ...
Iteration 350 ...
Iteration 375 ...
Iteration 400 ...
Iteration 425 ...
Iteration 450 ...
Iteration 475 ...
Iteration 500 ...
Iteration 525 ...
Iteration 550 ...
Iteration 575 ...
Iteration 600 ...
Gibbs sampling completed!</code></pre>
</div>
</div>
<p>In this code: - <code>alpha = 50/K</code> and <code>delta = 0.1</code> are hyperparameters that control the distribution of topics in documents and words in topics, respectively. - <code>seed = 123</code> ensures reproducibility. - <code>burnin = 100</code> and <code>iter = 500</code> control the number of Gibbs sampling iterations.</p>
</section>
<section id="extract-posterior-distributions" class="level3" data-number="17.8.2">
<h3 data-number="17.8.2" class="anchored" data-anchor-id="extract-posterior-distributions"><span class="header-section-number">17.8.2</span> Extract Posterior Distributions</h3>
<p>The <code>posterior</code> function extracts the posterior distributions from the trained LDA model, giving us insight into the topics and terms.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the posterior distributions of the LDA model</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>tmResult <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda_model)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the attributes of the result</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(tmResult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "terms"  "topics"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the document-topic distribution to a CSV file</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(tmResult<span class="sc">$</span>topics, <span class="st">"tmResult.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>posterior</code> function returns a list with: - <code>tmResult$topics</code>: a document-topic distribution matrix (<code>theta</code>), where each row represents a document and each column represents a topic. - <code>tmResult$terms</code>: a topic-term distribution matrix (<code>beta</code>), where each row represents a topic and each column represents a term.</p>
</section>
<section id="analyze-the-topic-term-distribution-beta" class="level3" data-number="17.8.3">
<h3 data-number="17.8.3" class="anchored" data-anchor-id="analyze-the-topic-term-distribution-beta"><span class="header-section-number">17.8.3</span> Analyze the Topic-Term Distribution (<code>beta</code>)</h3>
<p>The <code>beta</code> matrix shows the probability of each word appearing in each topic. This information can help us interpret the topics by identifying the most likely words for each one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the topic-term distribution matrix</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> tmResult<span class="sc">$</span>terms</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the beta matrix to a CSV file</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(beta, <span class="st">'beta.csv'</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the dimensions of the beta matrix</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(beta)  <span class="co"># Expected output: K x ncol(DTM)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   10 1287</code></pre>
</div>
</div>
<p>To verify that each row of <code>beta</code> represents a probability distribution (i.e., sums to 1):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify that each row in beta sums to 1</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4  5  6  7  8  9 10 
 1  1  1  1  1  1  1  1  1  1 </code></pre>
</div>
</div>
</section>
<section id="analyze-the-document-topic-distribution-theta" class="level3" data-number="17.8.4">
<h3 data-number="17.8.4" class="anchored" data-anchor-id="analyze-the-document-topic-distribution-theta"><span class="header-section-number">17.8.4</span> Analyze the Document-Topic Distribution (<code>theta</code>)</h3>
<p>Each row in the <code>theta</code> matrix represents a document, and each column represents a topic. The values indicate the probability of each topic in each document.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the document-topic distribution matrix</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> tmResult<span class="sc">$</span>topics</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the theta matrix to a CSV file</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(theta, <span class="st">'theta.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-and-save-a-matrix-of-top-words-for-each-topic" class="level3" data-number="17.8.5">
<h3 data-number="17.8.5" class="anchored" data-anchor-id="create-and-save-a-matrix-of-top-words-for-each-topic"><span class="header-section-number">17.8.5</span> Create and Save a Matrix of Top Words for Each Topic</h3>
<p>To facilitate interpretation, it’s often helpful to list the top words for each topic in a more human-readable format. We can transpose the <code>beta</code> matrix and round values to simplify the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the beta values to three decimal places for readability</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>phi_matrix <span class="ot">&lt;-</span> <span class="fu">round</span>(beta, <span class="dv">3</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Transpose and convert to data frame for saving</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>T_phi_matrix <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(phi_matrix))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(T_phi_matrix) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">"Topic"</span>, <span class="dv">1</span><span class="sc">:</span>K)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the transposed matrix with topic words</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(T_phi_matrix, <span class="st">"lda_topic_words.csv"</span>)</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few words for each topic</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>T_phi_matrix[<span class="dv">1</span><span class="sc">:</span>K, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Topic 1 Topic 2 Topic 3 Topic 4 Topic 5 Topic 6 Topic 7 Topic 8
English          0.001   0.000   0.013   0.000   0.058   0.000   0.000   0.094
Korean           0.000   0.000   0.000   0.002   0.000   0.000   0.000   0.000
able             0.000   0.000   0.000   0.002   0.000   0.002   0.000   0.000
acquire          0.000   0.000   0.000   0.000   0.000   0.004   0.000   0.000
arise            0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.001
basis            0.000   0.000   0.000   0.000   0.000   0.001   0.006   0.000
characteristic   0.000   0.000   0.006   0.000   0.000   0.000   0.004   0.000
correct          0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.000
difference       0.033   0.002   0.000   0.000   0.001   0.000   0.000   0.000
education        0.000   0.000   0.000   0.000   0.000   0.000   0.000   0.048
               Topic 9 Topic 10
English          0.005    0.002
Korean           0.014    0.000
able             0.001    0.000
acquire          0.000    0.000
arise            0.000    0.000
basis            0.000    0.000
characteristic   0.000    0.000
correct          0.003    0.000
difference       0.000    0.000
education        0.000    0.000</code></pre>
</div>
</div>
<p>In this transposed matrix, each row corresponds to a word, and each column represents a topic, showing the top words for each topic.</p>
<p>This analysis yields several matrices:</p>
<ul>
<li><p><strong><code>beta</code></strong>: Topic-term distribution, showing the most probable words per topic.</p></li>
<li><p><strong><code>theta</code></strong>: Document-topic distribution, showing topic proportions for each document.</p></li>
<li><p><strong>Transposed <code>beta</code></strong>: A matrix of top words per topic, which can be saved for easy inspection.</p></li>
</ul>
<p>These outputs allow us to interpret and label topics meaningfully, bringing us closer to understanding the thematic structure in our dataset.</p>
</section>
</section>
<section id="extracting-and-visualizing-topics" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="extracting-and-visualizing-topics"><span class="header-section-number">17.9</span> Extracting and Visualizing Topics</h2>
<section id="extract-the-top-15-words-for-each-topic" class="level3" data-number="17.9.1">
<h3 data-number="17.9.1" class="anchored" data-anchor-id="extract-the-top-15-words-for-each-topic"><span class="header-section-number">17.9.1</span> Extract the Top 15 Words for Each Topic</h3>
<p>The <code>terms</code> function can be used to identify the top terms in each topic. In this example, we extract the 15 most probable words for each topic and save the results to a CSV file for easy reference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the top 15 words for each topic</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>top_words <span class="ot">&lt;-</span> <span class="fu">terms</span>(lda_model, <span class="dv">15</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the top words to a CSV file</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(top_words, <span class="st">"lda_topic_15words.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code produces a table where each column represents a topic, and each row lists one of the top 15 words associated with that topic. This table can be helpful for interpreting and labeling topics.</p>
</section>
<section id="visualize-the-lda-model-with-ldavis" class="level3" data-number="17.9.2">
<h3 data-number="17.9.2" class="anchored" data-anchor-id="visualize-the-lda-model-with-ldavis"><span class="header-section-number">17.9.2</span> Visualize the LDA Model with <code>LDAvis</code></h3>
<p>Visualizing the LDA model provides a dynamic way to explore topics. The <code>LDAvis</code> package, combined with the <code>topicmodels2LDAvis</code> function below, generates an interactive visualization that displays: - The distance between topics (e.g., similar topics will appear closer together). - The most influential words within each topic.</p>
<section id="install-and-load-required-libraries" class="level4" data-number="17.9.2.1">
<h4 data-number="17.9.2.1" class="anchored" data-anchor-id="install-and-load-required-libraries"><span class="header-section-number">17.9.2.1</span> Install and Load Required Libraries</h4>
<p>Ensure that <code>LDAvis</code> and <code>servr</code> are installed, as they are required for creating and serving the visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load required packages</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("LDAvis")</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(LDAvis)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("servr")</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(servr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-a-helper-function-for-ldavis" class="level4" data-number="17.9.2.2">
<h4 data-number="17.9.2.2" class="anchored" data-anchor-id="define-a-helper-function-for-ldavis"><span class="header-section-number">17.9.2.2</span> Define a Helper Function for <code>LDAvis</code></h4>
<p>To visualize a model created with the <code>topicmodels</code> package, we need a custom function to convert the LDA model to the format required by <code>LDAvis</code>. The following <code>topicmodels2LDAvis</code> function extracts the necessary information from the <code>lda_model</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to convert the LDA model to LDAvis format</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>topicmodels2LDAvis <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...){</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    post <span class="ot">&lt;-</span> topicmodels<span class="sc">::</span><span class="fu">posterior</span>(x)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">ncol</span>(post[[<span class="st">"topics"</span>]]) <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="fu">stop</span>(<span class="st">"The model must contain &gt; 2 topics"</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    mat <span class="ot">&lt;-</span> x<span class="sc">@</span>wordassignments</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    LDAvis<span class="sc">::</span><span class="fu">createJSON</span>(</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">phi =</span> post[[<span class="st">"terms"</span>]], </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">theta =</span> post[[<span class="st">"topics"</span>]],</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">vocab =</span> <span class="fu">colnames</span>(post[[<span class="st">"terms"</span>]]),</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">doc.length =</span> slam<span class="sc">::</span><span class="fu">row_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">term.frequency =</span> slam<span class="sc">::</span><span class="fu">col_sums</span>(mat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This function extracts:</p>
<ul>
<li><p><code>phi</code> (topic-term distribution matrix).</p></li>
<li><p><code>theta</code> (document-topic distribution matrix).</p></li>
<li><p><code>vocab</code> (list of terms).</p></li>
<li><p><code>doc.length</code> (number of terms per document).</p></li>
<li><p><code>term.frequency</code> (frequency of each term in the entire corpus).</p></li>
</ul>
</section>
<section id="generate-and-display-the-visualization" class="level4" data-number="17.9.2.3">
<h4 data-number="17.9.2.3" class="anchored" data-anchor-id="generate-and-display-the-visualization"><span class="header-section-number">17.9.2.3</span> Generate and Display the Visualization</h4>
<p>Finally, we use the <code>serVis</code> function from <code>LDAvis</code> to create and serve the visualization locally in a web browser.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate and view the LDA visualization</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>LDAvis<span class="sc">::</span><span class="fu">serVis</span>(<span class="fu">topicmodels2LDAvis</span>(lda_model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/Screenshot 2024-11-12 at 22.50.35.png" class="img-fluid"></p>
<p>This command opens an interactive visualization in your browser, where:</p>
<ul>
<li><p>Each circle represents a topic.</p></li>
<li><p>The size of each circle indicates the prevalence of the topic in the corpus.</p></li>
<li><p>Words within each topic are displayed on the right, ranked by their importance.</p></li>
</ul>
</section>
</section>
</section>
<section id="topic-ranking-and-trends" class="level2" data-number="17.10">
<h2 data-number="17.10" class="anchored" data-anchor-id="topic-ranking-and-trends"><span class="header-section-number">17.10</span> Topic Ranking and Trends</h2>
<p>This section expands on <strong>Topic Ranking</strong> and introduces a <strong>Hot and Cold Topics Analysis</strong>. Topic ranking enables us to identify and name dominant topics across the collection. Hot and cold topic analysis explores topic trends over time, identifying which topics are gaining or losing prominence.</p>
<section id="step-1-rank-topics-by-defining-terms" class="level3" data-number="17.10.1">
<h3 data-number="17.10.1" class="anchored" data-anchor-id="step-1-rank-topics-by-defining-terms"><span class="header-section-number">17.10.1</span> Step 1: Rank Topics by Defining Terms</h3>
<p>To create meaningful names for each topic, we can identify the top defining words per topic based on specificity rather than mere frequency. The <code>top.topic.words</code> function from the <code>lda</code> package ranks terms by specificity, which highlights unique terms that best describe each topic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the lda package if not installed</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('lda')</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lda)</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate topic names by selecting the top 6 terms for each topic</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>topicNames <span class="ot">&lt;-</span> <span class="fu">apply</span>(lda<span class="sc">::</span><span class="fu">top.topic.words</span>(beta, <span class="dv">6</span>, <span class="at">by.score =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>, paste, <span class="at">collapse =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this code: - <code>top.topic.words(beta, 6, by.score = TRUE)</code> selects the top six terms per topic from the <code>beta</code> matrix. - <code>apply(..., 2, paste, collapse = " ")</code> concatenates these terms into a single name for each topic.</p>
</section>
<section id="step-2-calculate-overall-topic-proportions" class="level3" data-number="17.10.2">
<h3 data-number="17.10.2" class="anchored" data-anchor-id="step-2-calculate-overall-topic-proportions"><span class="header-section-number">17.10.2</span> Step 2: Calculate Overall Topic Proportions</h3>
<p>To assess which topics are most prevalent in the corpus, we calculate the average topic proportions across all documents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average topic proportions across all documents</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>topicProportions <span class="ot">&lt;-</span> <span class="fu">colSums</span>(theta) <span class="sc">/</span> <span class="fu">nrow</span>(dtm)  <span class="co"># mean probabilities over all documents</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign names to the topic proportions</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(topicProportions) <span class="ot">&lt;-</span> topicNames</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Save topic proportions to a CSV</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(topicProportions, <span class="st">"topicProportions.csv"</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Display topics sorted by proportion</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>sorted_topic_proportions <span class="ot">&lt;-</span> <span class="fu">sort</span>(topicProportions, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>sorted_topic_proportions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    teacher teaching English program education school 
                                           0.10690439 
  activity school elementary student English textbook 
                                           0.10323217 
             learn use learning student online course 
                                           0.10148885 
 language classroom practice approach context culture 
                                           0.10127252 
      student write writing data participant feedback 
                                           0.10016247 
                  word read use reading strategy text 
                                           0.09944170 
        develop material child model question purpose 
                                           0.09925692 
        test speak proficiency listen high assessment 
                                           0.09641813 
vocabulary effect instruction learner difference type 
                                           0.09600700 
            learner task self factor interaction role 
                                           0.09581585 </code></pre>
</div>
</div>
<p>The <code>topicProportions</code> vector indicates the overall importance of each topic in the corpus. Sorting by these values reveals the most prominent topics.</p>
</section>
<section id="step-3-count-primary-topics-in-each-document" class="level3" data-number="17.10.3">
<h3 data-number="17.10.3" class="anchored" data-anchor-id="step-3-count-primary-topics-in-each-document"><span class="header-section-number">17.10.3</span> Step 3: Count Primary Topics in Each Document</h3>
<p>Next, we can identify the most dominant topic (primary topic) within each document, helping us understand which topics are most frequently the main focus of documents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize a counter for primary topics</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>countsOfPrimaryTopics <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, K)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(countsOfPrimaryTopics) <span class="ot">&lt;-</span> topicNames</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Count primary topics across documents</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dtm)) {</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  topicsPerDoc <span class="ot">&lt;-</span> theta[i, ]                <span class="co"># Select topic distribution for document i</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  primaryTopic <span class="ot">&lt;-</span> <span class="fu">order</span>(topicsPerDoc, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span>]  <span class="co"># Identify the primary topic</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  countsOfPrimaryTopics[primaryTopic] <span class="ot">&lt;-</span> countsOfPrimaryTopics[primaryTopic] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Save primary topic counts to CSV</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(countsOfPrimaryTopics, <span class="st">'countsOfPrimaryTopics.csv'</span>)</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Display sorted counts of primary topics</span></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a>sorted_counts_primary_topics <span class="ot">&lt;-</span> <span class="fu">sort</span>(countsOfPrimaryTopics, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>sorted_counts_primary_topics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    teacher teaching English program education school 
                                                  209 
  activity school elementary student English textbook 
                                                  178 
                  word read use reading strategy text 
                                                  173 
      student write writing data participant feedback 
                                                  165 
 language classroom practice approach context culture 
                                                  163 
             learn use learning student online course 
                                                  143 
        test speak proficiency listen high assessment 
                                                  139 
vocabulary effect instruction learner difference type 
                                                  128 
            learner task self factor interaction role 
                                                  115 
        develop material child model question purpose 
                                                  104 </code></pre>
</div>
</div>
<p>This count indicates how often each topic is the primary focus in documents, providing a measure of topic prominence.</p>
</section>
</section>
<section id="hot-and-cold-topics-analysis" class="level2" data-number="17.11">
<h2 data-number="17.11" class="anchored" data-anchor-id="hot-and-cold-topics-analysis"><span class="header-section-number">17.11</span> Hot and Cold Topics Analysis</h2>
<p>To observe trends over time, we analyze topic proportions across years to identify “hot” (increasing) and “cold” (decreasing) topics.</p>
<section id="step-1-prepare-data-for-temporal-analysis" class="level3" data-number="17.11.1">
<h3 data-number="17.11.1" class="anchored" data-anchor-id="step-1-prepare-data-for-temporal-analysis"><span class="header-section-number">17.11.1</span> Step 1: Prepare Data for Temporal Analysis</h3>
<p>We first convert tokenized data to a “wide” format to facilitate yearly aggregation. This transformation makes each document a single row, with terms as columns, simplifying further analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Spread tokens to wide format</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>tokens_year <span class="ot">&lt;-</span> tokens <span class="sc">%&gt;%</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(doc_id) <span class="sc">%&gt;%</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ind =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">spread</span>(<span class="at">key =</span> ind, <span class="at">value =</span> lemma)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace NA values with empty strings</span></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>tokens_year[<span class="fu">is.na</span>(tokens_year)] <span class="ot">&lt;-</span> <span class="st">""</span> </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Unite terms back into a single column for each document</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>tokens_year <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">unite</span>(tokens_year, abstract, <span class="sc">-</span>doc_id, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>tokens_year<span class="sc">$</span>abstract <span class="ot">&lt;-</span> <span class="fu">trimws</span>(tokens_year<span class="sc">$</span>abstract)</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge with original data to add additional document information (e.g., year)</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>tokens_year <span class="ot">&lt;-</span> <span class="fu">merge</span>(<span class="at">x =</span> tokens_year, <span class="at">y =</span> data, <span class="at">by =</span> <span class="st">"doc_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-2-calculate-topic-proportions-over-time" class="level3" data-number="17.11.2">
<h3 data-number="17.11.2" class="anchored" data-anchor-id="step-2-calculate-topic-proportions-over-time"><span class="header-section-number">17.11.2</span> Step 2: Calculate Topic Proportions Over Time</h3>
<p>By aggregating topic proportions by year, we can observe how each topic’s importance changes over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load reshape if not already installed</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages('reshape')</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lubridate':

    stamp</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, smiths</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean topic proportion per year</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>topic_proportion_per_year <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(theta, <span class="at">by =</span> <span class="fu">list</span>(<span class="at">year =</span> tokens_year<span class="sc">$</span>year), mean)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Save topic proportions per year to a CSV</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(topic_proportion_per_year, <span class="st">'topic_proportion_per_year.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code creates a table where each row represents a year and each column represents the average proportion of a topic for that year.</p>
</section>
</section>
<section id="hot-and-cold-topics-analysis-1" class="level2" data-number="17.12">
<h2 data-number="17.12" class="anchored" data-anchor-id="hot-and-cold-topics-analysis-1"><span class="header-section-number">17.12</span> Hot and Cold Topics Analysis</h2>
<p>In this section, we conduct <strong>Hot and Cold Topics Analysis</strong> using a time-series approach to identify topics that have increased (hot topics) or decreased (cold topics) in prominence over time. This analysis involves calculating topic trends across years, assessing statistical significance, and visualizing the most prominent hot and cold topics.</p>
<section id="step-1-calculate-mean-topic-proportions-by-year" class="level3" data-number="17.12.1">
<h3 data-number="17.12.1" class="anchored" data-anchor-id="step-1-calculate-mean-topic-proportions-by-year"><span class="header-section-number">17.12.1</span> Step 1: Calculate Mean Topic Proportions by Year</h3>
<p>To identify hot and cold topics, we first calculate the mean proportion of each topic per year. This provides a time series of topic prevalence that we can analyze for trends.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract unique years</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">levels</span>(<span class="fu">factor</span>(tokens_year<span class="sc">$</span>year))  <span class="co"># Check years, e.g., 2000 ~ 2019</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of topics</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>topics_n <span class="ot">&lt;-</span> K    <span class="co"># In this case, 10</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the document-topic distribution matrix</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>theta_2 <span class="ot">&lt;-</span> <span class="fu">posterior</span>(lda_model)<span class="sc">$</span>topics</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the mean topic proportions by year</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>theta_mean_by_year_by <span class="ot">&lt;-</span> <span class="fu">by</span>(theta_2, tokens_year<span class="sc">$</span>year, colMeans)</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>theta_mean_by_year <span class="ot">&lt;-</span> <span class="fu">do.call</span>(<span class="st">"rbind"</span>, theta_mean_by_year_by)  <span class="co"># Combine results into a matrix</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns and create a time series object</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(theta_mean_by_year) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="dv">1</span><span class="sc">:</span>topics_n)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>theta_mean_by_year_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(theta_mean_by_year, <span class="at">start =</span> <span class="fu">as.integer</span>(years[<span class="dv">1</span>]))</span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>theta_mean_by_year_time <span class="ot">&lt;-</span> <span class="fu">time</span>(theta_mean_by_year)</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Save results to CSV</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(theta_mean_by_year, <span class="st">"theta_mean_by_year.csv"</span>)</span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>theta_mean_by_year_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
attr(,"tsp")
[1]  1 20  1</code></pre>
</div>
</div>
</section>
<section id="step-2-identify-hot-and-cold-topics-with-linear-regression" class="level3" data-number="17.12.2">
<h3 data-number="17.12.2" class="anchored" data-anchor-id="step-2-identify-hot-and-cold-topics-with-linear-regression"><span class="header-section-number">17.12.2</span> Step 2: Identify Hot and Cold Topics with Linear Regression</h3>
<p>To determine which topics are trending up (hot) or down (cold) over time, we fit a linear regression model for each topic’s time series. The slope of each model indicates the direction and magnitude of change.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform linear regression on topic proportions over time</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>theta_mean_lm <span class="ot">&lt;-</span> <span class="fu">apply</span>(theta_mean_by_year, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">lm</span>(x <span class="sc">~</span> theta_mean_by_year_time))</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract regression coefficients and p-values</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>theta_mean_lm_coef <span class="ot">&lt;-</span> <span class="fu">lapply</span>(theta_mean_lm, <span class="cf">function</span>(x) <span class="fu">coef</span>(<span class="fu">summary</span>(x)))</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract significance (p-values) and slopes</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>theta_mean_lm_coef_sign <span class="ot">&lt;-</span> <span class="fu">sapply</span>(theta_mean_lm_coef, <span class="st">'['</span>, <span class="st">"theta_mean_by_year_time"</span>, <span class="st">"Pr(&gt;|t|)"</span>)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>theta_mean_lm_coef_slope <span class="ot">&lt;-</span> <span class="fu">sapply</span>(theta_mean_lm_coef, <span class="st">'['</span>, <span class="st">"theta_mean_by_year_time"</span>, <span class="st">"Estimate"</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate positive and negative slopes for analysis</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>theta_mean_lm_coef_slope_pos <span class="ot">&lt;-</span> theta_mean_lm_coef_slope[theta_mean_lm_coef_slope <span class="sc">&gt;=</span> <span class="dv">0</span>]</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>theta_mean_lm_coef_slope_neg <span class="ot">&lt;-</span> theta_mean_lm_coef_slope[theta_mean_lm_coef_slope <span class="sc">&lt;</span> <span class="dv">0</span>]</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Save positive and negative slopes to CSV</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(theta_mean_lm_coef_slope_pos, <span class="st">'theta_mean_lm_coef_slope_positive.csv'</span>)</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(theta_mean_lm_coef_slope_neg, <span class="st">'theta_mean_lm_coef_slope_negative.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-3-evaluate-significance-levels" class="level3" data-number="17.12.3">
<h3 data-number="17.12.3" class="anchored" data-anchor-id="step-3-evaluate-significance-levels"><span class="header-section-number">17.12.3</span> Step 3: Evaluate Significance Levels</h3>
<p>We test the statistical significance of each trend using various p-value thresholds to determine which trends are likely meaningful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set p-value thresholds</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>p_level <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify topics with significant slopes at each p-level</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>significance_total <span class="ot">&lt;-</span> <span class="fu">sapply</span>(p_level, <span class="cf">function</span>(x) (theta_mean_lm_coef_sign[theta_mean_lm_coef_sign <span class="sc">&lt;</span> x]))</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>significance_neg <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p_level), <span class="cf">function</span>(x) <span class="fu">intersect</span>(<span class="fu">names</span>(theta_mean_lm_coef_slope_neg), <span class="fu">names</span>(significance_total[[x]])))</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>significance_pos <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p_level), <span class="cf">function</span>(x) <span class="fu">intersect</span>(<span class="fu">names</span>(theta_mean_lm_coef_slope_pos), <span class="fu">names</span>(significance_total[[x]])))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="step-4-visualize-hot-and-cold-topics" class="level3" data-number="17.12.4">
<h3 data-number="17.12.4" class="anchored" data-anchor-id="step-4-visualize-hot-and-cold-topics"><span class="header-section-number">17.12.4</span> Step 4: Visualize Hot and Cold Topics</h3>
<p>Using the <code>lattice</code> package, we can plot the time series of hot and cold topics to observe their changes over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select top hot and cold topics for visualization</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>topics_cold <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">sort</span>(theta_mean_lm_coef_slope[significance_neg[[<span class="dv">2</span>]]], <span class="at">decreasing =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>topics_hot <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">sort</span>(theta_mean_lm_coef_slope[significance_pos[[<span class="dv">2</span>]]], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine selected hot and cold topics into a single time series matrix</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>cold_and_hot_ts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(theta_mean_by_year_ts[, topics_cold[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]],</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>                         theta_mean_by_year_ts[, topics_hot[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]], <span class="at">deparse.level =</span> <span class="dv">0</span>)  <span class="co"># Adjust numbers as needed</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename columns to indicate topic numbers</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cold_and_hot_ts) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">c</span>(topics_cold[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], topics_hot[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot hot and cold topics over time</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xyplot</span>(cold_and_hot_ts, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), </span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">screens =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Cold topics"</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">"Hot topics"</span>, <span class="dv">3</span>)),  <span class="co"># Adjust as needed</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">superpose =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.2</span>), </span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Mean "</span>, theta)), </span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"g"</span>), </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">space =</span> <span class="st">"right"</span>),  </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="at">alternating =</span> <span class="cn">FALSE</span>))</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="17.Topic_Modeling_Example_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot displays the time trends for the top hot and cold topics. Hot topics are increasing over time, while cold topics are decreasing, providing a visual representation of shifting thematic focus in the corpus.</p>
</section>
<section id="step-5-summarize-time-series-analysis-results" class="level3" data-number="17.12.5">
<h3 data-number="17.12.5" class="anchored" data-anchor-id="step-5-summarize-time-series-analysis-results"><span class="header-section-number">17.12.5</span> Step 5: Summarize Time-Series Analysis Results</h3>
<p>To further analyze, extract regression summaries for each topic’s time series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract detailed regression summaries for all topics</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>reg_result <span class="ot">&lt;-</span> <span class="fu">lapply</span>(theta_mean_lm, <span class="cf">function</span>(x) <span class="fu">summary</span>(x))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>reg_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`1`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0106224 -0.0054520 -0.0006585  0.0030597  0.0123526 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.0791519  0.0033328  23.749 4.87e-15 ***
theta_mean_by_year_time 0.0014388  0.0002782   5.171 6.41e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007175 on 18 degrees of freedom
Multiple R-squared:  0.5977,    Adjusted R-squared:  0.5754 
F-statistic: 26.74 on 1 and 18 DF,  p-value: 6.415e-05


$`2`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0140039 -0.0059298  0.0005148  0.0034152  0.0136802 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.0877861  0.0032552  26.968 5.24e-16 ***
theta_mean_by_year_time 0.0007345  0.0002717   2.703   0.0146 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007008 on 18 degrees of freedom
Multiple R-squared:  0.2887,    Adjusted R-squared:  0.2492 
F-statistic: 7.307 on 1 and 18 DF,  p-value: 0.01456


$`3`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0133495 -0.0059436  0.0004885  0.0056141  0.0145932 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.0902989  0.0037379  24.158 3.61e-15 ***
theta_mean_by_year_time 0.0005222  0.0003120   1.674    0.111    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008047 on 18 degrees of freedom
Multiple R-squared:  0.1347,    Adjusted R-squared:  0.08659 
F-statistic: 2.801 on 1 and 18 DF,  p-value: 0.1115


$`4`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.012520 -0.006555 -0.000802  0.003934  0.021989 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.0786041  0.0045596  17.239 1.23e-12 ***
theta_mean_by_year_time 0.0018166  0.0003806   4.773 0.000152 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.009816 on 18 degrees of freedom
Multiple R-squared:  0.5586,    Adjusted R-squared:  0.5341 
F-statistic: 22.78 on 1 and 18 DF,  p-value: 0.0001522


$`5`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0182790 -0.0030607 -0.0003752  0.0042530  0.0218266 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.1112232  0.0040568  27.416 3.92e-16 ***
theta_mean_by_year_time -0.0006941  0.0003387  -2.049   0.0553 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008733 on 18 degrees of freedom
Multiple R-squared:  0.1892,    Adjusted R-squared:  0.1442 
F-statistic:   4.2 on 1 and 18 DF,  p-value: 0.05528


$`6`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.013077 -0.005287 -0.002604  0.005887  0.015043 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.1244954  0.0040789  30.522  &lt; 2e-16 ***
theta_mean_by_year_time -0.0019584  0.0003405  -5.751 1.88e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008781 on 18 degrees of freedom
Multiple R-squared:  0.6476,    Adjusted R-squared:  0.628 
F-statistic: 33.08 on 1 and 18 DF,  p-value: 1.882e-05


$`7`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
       Min         1Q     Median         3Q        Max 
-0.0132064 -0.0029839 -0.0000425  0.0017775  0.0147170 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.1081636  0.0031731  34.087   &lt;2e-16 ***
theta_mean_by_year_time -0.0007511  0.0002649  -2.836    0.011 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.006831 on 18 degrees of freedom
Multiple R-squared:  0.3088,    Adjusted R-squared:  0.2704 
F-statistic:  8.04 on 1 and 18 DF,  p-value: 0.01097


$`8`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.015552 -0.009472 -0.005539  0.006255  0.040635 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.113451   0.006720  16.883 1.76e-12 ***
theta_mean_by_year_time -0.000597   0.000561  -1.064    0.301    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01447 on 18 degrees of freedom
Multiple R-squared:  0.0592,    Adjusted R-squared:  0.006931 
F-statistic: 1.133 on 1 and 18 DF,  p-value: 0.3013


$`9`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.010320 -0.006048 -0.002329  0.004951  0.013002 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)             0.0887010  0.0033473   26.50 7.14e-16 ***
theta_mean_by_year_time 0.0009250  0.0002794    3.31  0.00389 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.007206 on 18 degrees of freedom
Multiple R-squared:  0.3784,    Adjusted R-squared:  0.3439 
F-statistic: 10.96 on 1 and 18 DF,  p-value: 0.003891


$`10`

Call:
lm(formula = x ~ theta_mean_by_year_time)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.015222 -0.005836  0.001027  0.004734  0.021663 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              0.1181249  0.0041647  28.364  &lt; 2e-16 ***
theta_mean_by_year_time -0.0014367  0.0003477  -4.132 0.000625 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.008965 on 18 degrees of freedom
Multiple R-squared:  0.4868,    Adjusted R-squared:  0.4583 
F-statistic: 17.08 on 1 and 18 DF,  p-value: 0.0006254</code></pre>
</div>
</div>
<p>The <code>reg_result</code> object contains detailed regression summaries for each topic, including coefficients, p-values, and R-squared values.</p>
<p><strong>Summary</strong></p>
<p>This hot and cold topics analysis highlights the changing prominence of topics over time:</p>
<ul>
<li><p><strong>Hot Topics</strong>: Topics with significantly positive trends.</p></li>
<li><p><strong>Cold Topics</strong>: Topics with significantly negative trends.</p></li>
</ul>
<p>These trends provide insights into the evolution of topics, revealing which areas of discussion have gained or lost interest. This analysis is especially valuable for diachronic studies and can uncover shifts in focus across different time periods in the dataset.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./16.Topic_Modeling.html" class="pagination-link" aria-label="Topic Modeling in Python">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Topic Modeling in Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./A.assignment1.html" class="pagination-link" aria-label="Assignment #01">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Assignment #01</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>